truncate table channels;
truncate table sales;
truncate table customers;
truncate table countries;
truncate table products;
truncate table promotions;
truncate table supplementary_demographics;
truncate table times;
truncate table costs;

/* Replace the <region name>, <tenant name>, <bucket name> with your actual values in the defination of the varaible bucket_uri.*/
define bucket_uri = 'https://swiftobjectstorage.<region name>.oraclecloud.com/v1/<tenant name>/<bucket name>/';

begin
 dbms_cloud.copy_data(
    table_name =>'CHANNELS',
    credential_name =>'OBJ_STORE_CRED_1',
    /* To construct a complete URI, the variable bucket_uri is concatenated to the name of a data file below.*/
    file_uri_list => '&bucket_uri' || 'chan_v3.dat',
    format => json_object('ignoremissingcolumns' value 'true', 'removequotes' value 'true')
 );
end;
/

begin
 dbms_cloud.copy_data(
    table_name =>'SALES',
    credential_name =>'OBJ_STORE_CRED_1',
    file_uri_list => '&bucket_uri' || 'sale1v3.dat',
    format => json_object('ignoremissingcolumns' value 'true', 'removequotes' value 'true', 'dateformat' value 'YYYY-MM-DD', 'blankasnull' value 'true')
 );
end;
/

begin
 dbms_cloud.copy_data(
    table_name =>'CUSTOMERS',
    credential_name =>'OBJ_STORE_CRED_1',
    file_uri_list => '&bucket_uri' || 'cust1v3.dat',
    format => json_object('ignoremissingcolumns' value 'true', 'removequotes' value 'true', 'dateformat' value 'YYYY-MM-DD-HH24-MI-SS')
 );
end;
/

insert into countries select * from SH.countries;
insert into products select * from SH.products;
insert into promotions select * from SH.promotions;
insert into supplementary_demographics select * from SH.supplementary_demographics;
insert into times select * from SH.times;
insert into costs select * from SH.costs;
